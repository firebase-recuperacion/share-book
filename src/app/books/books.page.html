<ion-content [fullscreen]="true">
  <ion-toolbar>
    <ion-title size="large">Mis libros</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="openRegisterBook()">Registrar libro</ion-button>
    </ion-buttons>
  </ion-toolbar>
  <ion-grid>
    <ion-row>
      <ion-segment (ionChange)="segmentChanged($event)" value="{{ segment }}">
        <ion-segment-button value="reservations">
          <ion-label>Mis reservas</ion-label>
        </ion-segment-button>
        <ion-segment-button value="books">
          <ion-label>Mis libros</ion-label>
        </ion-segment-button>
      </ion-segment>
    </ion-row>
    <ng-container *ngIf="segment === 'books'">
      <ion-card *ngIf="(books$ | async)?.length === 0">
        <ion-card-content>
          <ion-text>No tiene libros registrados</ion-text>
        </ion-card-content>
      </ion-card>
      <ng-container *ngIf="(books$ | async)?.length > 0">
        <ion-row *ngFor="let book of books$ | async; index as i">
          <ion-card button (click)="openBookDetail(book)" style="width: 100%">
            <ion-card-header>
              <div class="imgHeader">
                <img [src]="book.photo" />
              </div>
              <ion-card-subtitle>{{ book.category }}</ion-card-subtitle>
              <ion-card-title>{{ book.title }}</ion-card-title>
            </ion-card-header>
            <ion-card-content>
              Dirección de recogida: {{ book.pickupAddress }}
              <br>
              <ion-text [hidden]="book.reserved === false">Reservado por: {{ book.reservedName }}</ion-text>
              <ion-button expand="block" [hidden]="book.reserved === false" (click)="deleteReservation(book)">Eliminar
                reserva</ion-button>
            </ion-card-content>
          </ion-card>
        </ion-row>
      </ng-container>
    </ng-container>
    <ng-container *ngIf="segment === 'reservations'">
      <ion-card *ngIf="(books$ | async)?.length === 0">
        <ion-card-content>
          <ion-text>No tiene libros reservados</ion-text>
        </ion-card-content>
      </ion-card>
      <ng-container *ngIf="(books$ | async)?.length > 0">
        <ion-row *ngFor="let book of books$ | async; index as i">
          <ion-card button (click)="openBookDetail(book)" style="width: 100%">
            <ion-card-header>
              <div class="imgHeader">
                <img [src]="book.photo" />
              </div>
              <ion-card-subtitle>{{ book.category }}</ion-card-subtitle>
              <ion-card-title>{{ book.title }}</ion-card-title>
            </ion-card-header>
            <ion-card-content>
              Dirección de recogida: {{ book.pickupAddress }}
              <ion-button expand="block" [hidden]="book.reserved === false" (click)="deleteReservation(book)">Eliminar
                mi reserva</ion-button>
            </ion-card-content>
          </ion-card>
        </ion-row>
      </ng-container>
    </ng-container>
  </ion-grid>
  <!-- </ion-list> -->
  <!-- </ion-card> -->
</ion-content>